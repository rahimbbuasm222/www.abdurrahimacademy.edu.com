<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Upload Panel</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #e9ecef; }
        
        /* ‡¶Æ‡ßá‡¶®‡ßÅ‡¶¨‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        nav { background: #2c3e50; overflow: hidden; margin-bottom: 50px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav a { float: left; display: block; color: white; text-align: center; padding: 14px 20px; text-decoration: none; font-size: 15px; }
        nav a:hover { background-color: #ddd; color: black; }

        /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶¨‡¶ï‡ßç‡¶∏‡ßá‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        .admin-box { background: white; max-width: 600px; margin: 0 auto; padding: 30px; border-radius: 10px; box-shadow: 0 0 15px rgba(0,0,0,0.1); margin-bottom: 50px; }
        h2 { text-align: center; color: #333; border-bottom: 2px solid #006a4e; padding-bottom: 10px; display: inline-block; }
        .header-center { text-align: center; margin-bottom: 20px; }

        label { font-weight: bold; color: #555; display: block; margin-top: 15px; }
        input, select, button { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 15px; }
        
        /* ‡¶°‡ßç‡¶∞‡¶™‡¶°‡¶æ‡¶â‡¶® ‡¶´‡ßã‡¶ï‡¶æ‡¶∏ */
        select:focus, input:focus { outline: 2px solid #006a4e; border-color: transparent; }

        /* ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® */
        .upload-btn { background: #006a4e; color: white; border: none; font-size: 16px; cursor: pointer; margin-top: 20px; transition: background 0.3s; }
        .upload-btn:hover { background: #004d3a; }

        /* ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        #admin-notice-list li {
            background: #f8f9fa;
            border-left: 5px solid #006a4e;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .delete-btn {
            background: #e74c3c;
            width: auto;
            padding: 6px 12px;
            color: white;
            font-size: 13px;
            margin: 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .delete-btn:hover { background: #c0392b; }

        .back-link { display: block; text-align: center; margin-top: 20px; text-decoration: none; color: #555; font-weight: bold; }
        .back-link:hover { color: #006a4e; }
    </style>
</head>
<body>

    <!-- ‡ßß. ‡¶Æ‡ßá‡¶®‡ßÅ‡¶¨‡¶æ‡¶∞ -->
    <nav>
        <a href="/">‡¶π‡ßã‡¶Æ</a>
        <a href="/about">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá</a>
        <a href="/services">‡¶∏‡ßá‡¶¨‡¶æ‡¶∏‡¶Æ‡ßÇ‡¶π</a>
        <a href="/gallery">‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø</a>
        <a href="/admin" style="background: #e74c3c;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</a>
    </nav>

    <div class="admin-box">
        <div class="header-center">
            <h2>üì¢ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞</h2>
        </div>

        <!-- ‡ß®. ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶™‡¶æ‡¶∞‡¶™‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶´‡¶∞‡ßç‡¶Æ -->
        <form onsubmit="uploadNotice(event)">
            
            <!-- ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶Ö‡¶™‡¶∂‡¶® (‡¶®‡¶§‡ßÅ‡¶®) -->
            <label>‡¶ß‡¶∞‡¶£ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® (Select Type):</label>
            <select id="category" required>
                <option value="‡¶®‡ßã‡¶ü‡¶ø‡¶∂">‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ (General Notice)</option>
                <option value="‡¶´‡¶≤‡¶æ‡¶´‡¶≤">‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ (Exam Result)</option>
                <option value="‡¶≠‡¶∞‡ßç‡¶§‡¶ø">‡¶≠‡¶∞‡ßç‡¶§‡¶ø ‡¶§‡¶•‡ßç‡¶Ø (Admission)</option>
                <option value="‡¶∞‡ßÅ‡¶ü‡¶ø‡¶®">‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶∞‡ßÅ‡¶ü‡¶ø‡¶® (Routine)</option>
            </select>

            <label>‡¶¨‡¶ø‡¶∑‡ßü / ‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ:</label>
            <input type="text" id="title" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶´‡¶≤‡¶æ‡¶´‡¶≤ ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂..." required>
            
            <label>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</label>
            <input type="date" id="date" required>
            
            <button type="submit" class="upload-btn">‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶® (Publish)</button>
        </form>

        <hr style="margin: 30px 0; border: 0; border-top: 1px solid #ddd;">

        <!-- ‡ß©. ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
        <h3 style="color: #333;">üìã ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡¶ø‡¶§ ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
        <p style="font-size: 12px; color: #777;">* ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (admin123) ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶® ‡¶π‡¶¨‡ßá</p>
        
        <ul id="admin-notice-list" style="list-style: none; padding: 0;">
            <!-- ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¶‡¶ø‡ßü‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá -->
        </ul>

        <a href="/" class="back-link">‚¨Ö ‡¶Æ‡ßÇ‡¶≤ ‡¶ì‡ßü‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</a>
    </div>

    <script>
        // ‡ßß. ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function uploadNotice(event) {
            event.preventDefault();
            
            const category = document.getElementById('category').value;
            const rawTitle = document.getElementById('title').value;
            const date = document.getElementById('date').value;

            // ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤ ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶¨
            // ‡¶Ø‡ßá‡¶Æ‡¶®: "[‡¶´‡¶≤‡¶æ‡¶´‡¶≤] ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶™‡¶∞‡ßÄ‡¶ï‡ßç‡¶∑‡¶æ ‡ß®‡ß¶‡ß®‡ß´"
            let finalTitle = rawTitle;
            if(category !== '‡¶®‡ßã‡¶ü‡¶ø‡¶∂') {
                finalTitle = `[${category}] ${rawTitle}`;
            }

            const response = await fetch('/api/notices', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title: finalTitle, date: date })
            });

            if (response.ok) {
                alert("‚úÖ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂‡¶ø‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                document.getElementById('title').value = '';
                document.getElementById('date').value = '';
                loadAdminNotices(); // ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
            } else {
                alert("‚ùå ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá! ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§");
            }
        }

        // ‡ß®. ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function loadAdminNotices() {
            try {
                const response = await fetch('/api/notices');
                const data = await response.json();
                const list = document.getElementById('admin-notice-list');
                list.innerHTML = '';

                data.forEach(notice => {
                    const li = document.createElement('li');
                    
                    // ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ
                    const dateObj = new Date(notice.date);
                    const formattedDate = dateObj.toLocaleDateString('bn-BD');

                    li.innerHTML = `
                        <span>
                            <small style="color:#777;">${formattedDate}</small><br>
                            <strong>${notice.title}</strong>
                        </span>
                        <button onclick="deleteNotice('${notice._id}')" class="delete-btn">Delete üóëÔ∏è</button>
                    `;
                    list.appendChild(li);
                });
            } catch (error) {
                console.error("Error loading list:", error);
            }
        }

        // ‡ß©. ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function deleteNotice(id) {
            const password = prompt("‚ö†Ô∏è ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶® (admin123):");
            
            if (password === 'admin123') { 
                if(confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§? ‡¶è‡¶ü‡¶ø ‡¶Ü‡¶∞ ‡¶´‡ßá‡¶∞‡¶§ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§")) {
                    await fetch('/api/notices/' + id, { method: 'DELETE' });
                    alert("‚úÖ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
                    loadAdminNotices(); 
                }
            } else if (password !== null) {
                alert("‚ùå ‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!");
            }
        }

        // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
        loadAdminNotices();
    </script>
</body>
</html>